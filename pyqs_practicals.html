<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ITNotesHub – PYQs</title>
  <meta name="description" content="Previous year question papers for TE IT students." />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="site-header sticky-nav glass">
    <nav class="top-nav">
      <a href="index.html" class="brand">ITNotesHub</a>
      <ul class="nav-links">
        <li><a href="notes.html">Notes</a></li>
        <li><a href="pyqs_practicals.html" class="active">PYQs</a></li>
        <li><a href="store.html">Store</a></li>
        <li><a href="about_contact.html">About & Contact</a></li>
      </ul>
      <button id="themeToggle" type="button" class="theme-toggle-btn" aria-label="Toggle light/dark theme">
        <svg class="icon icon-sun" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
        <svg class="icon icon-moon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
      </button>
    </nav>
    <div class="hero-head compact">
      <h1 class="hero-title">PYQs</h1>
      <p class="hero-tagline">Filter previous year question papers and solutions.</p>
    </div>
    <div class="controls hero-controls">
      <label>
        <span>Subject:</span>
        <select id="subjectFilter">
          <option value="all">All</option>
        </select>
      </label>
      <label class="search-wrap">
        <span>Search:</span>
        <input id="searchInput" type="text" placeholder="Search titles..." autocomplete="off" />
      </label>
      <label class="sort-wrap">
        <span>Sort:</span>
        <select id="sortSelect">
          <option value="recent">Recently Updated</option>
          <option value="title">Title A→Z</option>
        </select>
      </label>
    </div>
  </header>

  <main id="pyqContainer" class="notes"></main>

  <footer class="site-footer">
    <div class="footer-content">
      <p>&copy; <span id="year"></span> ITNotesHub</p>
      <p class="footer-links">
        <a href="about_contact.html" class="footer-link">About</a>
        <span class="separator">•</span>
        <a href="about_contact.html#contact" class="footer-link">Contact</a>
      </p>
    </div>
  </footer>

  <script src="theme.js"></script>
  <script>
    // Lightweight loader focusing on question papers (unit directories not needed here)
    const yearSpan = document.getElementById('year');
    yearSpan.textContent = new Date().getFullYear();
    const subjectFilter = document.getElementById('subjectFilter');
    const searchInput = document.getElementById('searchInput');
    const sortSelect = document.getElementById('sortSelect');
    const container = document.getElementById('pyqContainer');
    let subjects = [];

    async function load() {
      try {
        const resp = await fetch('resources.json',{cache:'no-store'});
        if (resp.ok) {
          const data = await resp.json();
          subjects = data.subjects || [];
        }
      } catch {}
      fillSubjects();
      render();
    }

    function fillSubjects(){
      while (subjectFilter.options.length>1) subjectFilter.remove(1);
      subjects.forEach(s=>{ const o=document.createElement('option'); o.value=s.name; o.textContent=s.name; subjectFilter.appendChild(o); });
    }

    function collectItems(){
      const collected=[];
      subjects.forEach(s=>{
        const examSets=[...(s.resources.Insem||[]), ...(s.resources.Endsem||[])];
        examSets.forEach(g=>{
          if (/Que Paper|Solution/i.test(g.title)){
            (g.items||[]).forEach(it=> collected.push({subject:s.name, group:g.title, title:it.title, url:it.url, mtime:it.mtime}));
          }
        });
      });
      return collected;
    }

    function render(){
      const term = searchInput.value.trim().toLowerCase();
      const subj = subjectFilter.value;
      let items = collectItems();
      if (subj !== 'all') items = items.filter(i=> i.subject===subj);
      if (term) items = items.filter(i=> i.title.toLowerCase().includes(term) || i.group.toLowerCase().includes(term));
      if (sortSelect.value==='title') items.sort((a,b)=> a.title.localeCompare(b.title));
      else if (sortSelect.value==='recent') items.sort((a,b)=> (Date.parse(b.mtime||0)||0)-(Date.parse(a.mtime||0)||0));

      container.innerHTML='';
      const list=document.createElement('div');
      list.className='flat-list';
      if (items.length===0){ container.innerHTML='<p class="empty-muted">No matching files.</p>'; return; }
      items.forEach(it=>{
        const card=document.createElement('div');
        card.className='row-card glass';
        const left=document.createElement('div'); left.className='row-main';
        left.innerHTML=`<strong>${it.title}</strong><span class="row-meta">${it.subject} • ${it.group}${it.mtime? ' • '+it.mtime.slice(0,10):''}</span>`;
        const actions=document.createElement('div'); actions.className='row-actions';
        const dl=document.createElement('a'); dl.href=it.url; dl.download=''; dl.className='small-btn'; dl.textContent='Download';
        actions.appendChild(dl);
        card.appendChild(left); card.appendChild(actions);
        list.appendChild(card);
      });
      container.appendChild(list);
    }

    subjectFilter.addEventListener('change', render);
    searchInput.addEventListener('input', render);
    sortSelect.addEventListener('change', render);

    load();
  </script>
</body>
</html>